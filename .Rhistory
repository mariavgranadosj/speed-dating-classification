title = paste("Partner's Decision by", subsetname, "and Gender"),
x = var,
y = "Count",
fill = "Decision"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No", "Yes"))
}
plot1 <- plot_decision_by_var(df_dating_race, "race_simple", "Subject's Race")
plot2 <- plot_decision_by_var(df_dating_race, "samerace", "Same Race")
plot_grid(
plot1, plot2,
ncol = 2,
nrow = 1,
align = "h"
)
#| message: false
#| warning: false
#| echo: false
plot1 <- plot_box_grid(subject_self_ratings,"Subject's Self-Assessed Characteristics")
plot2 <- plot_box_grid(partner_self_ratings,"Subject's Perceived Characteristics")
plot3 <- plot_box_grid(interests,"Subject Interests")
plot_grid(
plot1, plot2, plot3,
ncol = 3,
nrow = 1,
align = "h"
)
#| message: false
#| warning: false
#| echo: false
plot1 <- plot_box_grid(subject_self_ratings,"Subject's Self-Assessed Characteristics")
plot2 <- plot_box_grid(partner_self_ratings,"Subject's Perceived Characteristics")
plot3 <- plot_box_grid(interests,"Subject Interests")
plot_grid(
plot1, plot2, plot3,
ncol = 3,
nrow = 1,
align = "v"
)
#| message: false
#| warning: false
#| echo: false
#| fig.width: 18
#| fig.height: 8
simplify_race <- function(x) {
x <- str_trim(as.character(x))
fct_collapse(
factor(x),
"Asian/PI" = c("Asian/Pacific Islander/Asian-American"),
"White" = c("European/Caucasian-American"),
"Latinx" = c("Latino/Hispanic American"),
"Black"= c("Black/African American"),
"Other"= c("Other", "?")
)
}
df_dating_race <-  df_dating %>%
mutate(
race_simple    = simplify_race(race),
race_o_simple  = simplify_race(race_o))
# Partner's decision by race, faceted by gender
plot_decision_by_var <- function(data, var, subsetname) {
ggplot(data, aes(x = .data[[var]], fill = factor(decision))) +
geom_bar(alpha = 0.5) +
facet_wrap(~ gender, scales = "free") +
labs(
title = paste("Partner's Decision by", subsetname, "and Gender"),
x = var,
y = "Count",
fill = "Decision"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No", "Yes"))
}
gender_counts <- df_dating |>
count(gender, decision) |>
group_by(gender) |>
mutate(Percent = round(100 * n / sum(n), 1))
plot1 <- plot_decision_by_var(df_dating_race, "race_simple", "Subject's Race")
plot2 <- plot_decision_by_var(df_dating_race, "samerace", "Same Race")
plot3 <- ggplot(gender_counts, aes(x = gender, y = n, fill = factor(decision))) +
geom_col(position = "dodge", alpha = 0.6) +
geom_text(
aes(label = paste0(n, " (", Percent, "%)")),
position = position_dodge(width = 0.9),
vjust = -0.4,
size = 3
) +
labs(
title = "Decision Counts by Gender",
x = "Gender",
y = "Frequency",
fill = "Decision"
) +
scale_fill_manual(values = class_colors, labels = c("No","Yes")) +
theme_minimal(base_size = 14)
plot_grid(
plot1, plot2, plot3,
ncol = 3,
nrow = 1,
align = "h"
)
#| message: false
#| warning: false
#| echo: false
#| fig.width: 18
#| fig.height: 8
simplify_race <- function(x) {
x <- str_trim(as.character(x))
fct_collapse(
factor(x),
"Asian/PI" = c("Asian/Pacific Islander/Asian-American"),
"White" = c("European/Caucasian-American"),
"Latinx" = c("Latino/Hispanic American"),
"Black"= c("Black/African American"),
"Other"= c("Other", "?")
)
}
df_dating_race <-  df_dating %>%
mutate(
race_simple    = simplify_race(race),
race_o_simple  = simplify_race(race_o))
# Partner's decision by race, faceted by gender
plot_decision_by_var <- function(data, var, subsetname) {
ggplot(data, aes(x = .data[[var]], fill = factor(decision))) +
geom_bar(alpha = 0.5) +
facet_wrap(~ gender, scales = "free") +
labs(
title = paste("Partner's Decision by", subsetname, "and Gender"),
x = var,
y = "Count",
fill = "Decision"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No", "Yes"))
}
plot1 <- plot_decision_by_var(df_dating_race, "race_simple", "Subject's Race")
plot2 <- plot_decision_by_var(df_dating_race, "samerace", "Same Race")
gender_counts <- df_dating |>
count(gender, decision) |>
group_by(gender) |>
mutate(Percent = round(100 * n / sum(n), 1))
plot3 <- ggplot(gender_counts, aes(x = gender, y = n, fill = factor(decision))) +
geom_col(position = "dodge", alpha = 0.6) +
geom_text(
aes(label = paste0(n, " (", Percent, "%)")),
position = position_dodge(width = 0.9),
vjust = -0.4,
size = 3
) +
labs(
title = "Decision Counts by Gender",
x = "Gender",
y = "Frequency",
fill = "Decision"
) +
theme( legend.position = "bottom")
scale_fill_manual(values = class_colors, labels = c("No","Yes")) +
theme_minimal(base_size = 14)
#| message: false
#| warning: false
#| echo: false
#| fig.width: 18
#| fig.height: 8
simplify_race <- function(x) {
x <- str_trim(as.character(x))
fct_collapse(
factor(x),
"Asian/PI" = c("Asian/Pacific Islander/Asian-American"),
"White" = c("European/Caucasian-American"),
"Latinx" = c("Latino/Hispanic American"),
"Black"= c("Black/African American"),
"Other"= c("Other", "?")
)
}
df_dating_race <-  df_dating %>%
mutate(
race_simple    = simplify_race(race),
race_o_simple  = simplify_race(race_o))
# Partner's decision by race, faceted by gender
plot_decision_by_var <- function(data, var, subsetname) {
ggplot(data, aes(x = .data[[var]], fill = factor(decision))) +
geom_bar(alpha = 0.5) +
facet_wrap(~ gender, scales = "free") +
labs(
title = paste("Partner's Decision by", subsetname, "and Gender"),
x = var,
y = "Count",
fill = "Decision"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No", "Yes"))
}
plot1 <- plot_decision_by_var(df_dating_race, "race_simple", "Subject's Race")
plot2 <- plot_decision_by_var(df_dating_race, "samerace", "Same Race")
gender_counts <- df_dating |>
count(gender, decision) |>
group_by(gender) |>
mutate(Percent = round(100 * n / sum(n), 1))
plot3 <- ggplot(gender_counts, aes(x = gender, y = n, fill = factor(decision))) +
geom_col(position = "dodge", alpha = 0.6) +
geom_text(
aes(label = paste0(n, " (", Percent, "%)")),
position = position_dodge(width = 0.9),
vjust = -0.4,
size = 3
) +
labs(
title = "Decision Counts by Gender",
x = "Gender",
y = "Frequency",
fill = "Decision"
) +
theme( legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No","Yes")) +
theme_minimal(base_size = 14)
plot_grid(
plot1, plot2, plot3,
ncol = 3,
nrow = 1,
align = "h"
)
#| message: false
#| warning: false
#| echo: false
#| fig.width: 18
#| fig.height: 8
simplify_race <- function(x) {
x <- str_trim(as.character(x))
fct_collapse(
factor(x),
"Asian/PI" = c("Asian/Pacific Islander/Asian-American"),
"White" = c("European/Caucasian-American"),
"Latinx" = c("Latino/Hispanic American"),
"Black"= c("Black/African American"),
"Other"= c("Other", "?")
)
}
df_dating_race <-  df_dating %>%
mutate(
race_simple    = simplify_race(race),
race_o_simple  = simplify_race(race_o))
# Partner's decision by race, faceted by gender
plot_decision_by_var <- function(data, var, subsetname) {
geom_col(data, aes(x = .data[[var]], fill = factor(decision))) +
geom_bar(alpha = 0.5) +
facet_wrap(~ gender, scales = "free") +
labs(
title = paste("Partner's Decision by", subsetname, "and Gender"),
x = var,
y = "Count",
fill = "Decision"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No", "Yes"))
}
plot1 <- plot_decision_by_var(df_dating_race, "race_simple", "Subject's Race")
#| message: false
#| warning: false
#| echo: false
#| fig.width: 18
#| fig.height: 8
simplify_race <- function(x) {
x <- str_trim(as.character(x))
fct_collapse(
factor(x),
"Asian/PI" = c("Asian/Pacific Islander/Asian-American"),
"White" = c("European/Caucasian-American"),
"Latinx" = c("Latino/Hispanic American"),
"Black"= c("Black/African American"),
"Other"= c("Other", "?")
)
}
df_dating_race <-  df_dating %>%
mutate(
race_simple    = simplify_race(race),
race_o_simple  = simplify_race(race_o))
# Partner's decision by race, faceted by gender
plot_decision_by_var <- function(data, var, subsetname) {
ggplot(data, aes(x = .data[[var]], fill = factor(decision))) +
geom_bar(alpha = 0.5) +
facet_wrap(~ gender, scales = "free") +
labs(
title = paste("Partner's Decision by", subsetname, "and Gender"),
x = var,
y = "Count",
fill = "Decision"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No", "Yes"))
}
plot1 <- plot_decision_by_var(df_dating_race, "race_simple", "Subject's Race")
plot2 <- plot_decision_by_var(df_dating_race, "samerace", "Same Race")
gender_counts <- df_dating |>
count(gender, decision) |>
group_by(gender) |>
mutate(Percent = round(100 * n / sum(n), 1))
plot3 <- ggplot(gender_counts, aes(x = gender, y = n, fill = factor(decision))) +
geom_col(position = "dodge", alpha = 0.6) +
geom_text(
aes(label = paste0(n, " (", Percent, "%)")),
position = position_dodge(width = 0.9),
vjust = -0.4,
size = 3
) +
labs(
title = "Decision Counts by Gender",
x = "Gender",
y = "Frequency",
fill = "Decision"
) +
theme( legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No","Yes")) +
theme_minimal(base_size = 14)
plot_grid(
plot1, plot2, plot3,
ncol = 3,
nrow = 1,
align = "h"
)
#| message: false
#| warning: false
#| echo: false
#| fig.width: 18
#| fig.height: 8
simplify_race <- function(x) {
x <- str_trim(as.character(x))
fct_collapse(
factor(x),
"Asian/PI" = c("Asian/Pacific Islander/Asian-American"),
"White" = c("European/Caucasian-American"),
"Latinx" = c("Latino/Hispanic American"),
"Black"= c("Black/African American"),
"Other"= c("Other", "?")
)
}
df_dating_race <-  df_dating %>%
mutate(
race_simple    = simplify_race(race),
race_o_simple  = simplify_race(race_o))
# Partner's decision by race, faceted by gender
plot_decision_by_var <- function(data, var, subsetname) {
ggplot(data, aes(x = .data[[var]], fill = factor(decision))) +
geom_bar(alpha = 0.5) +
facet_wrap(~ gender, scales = "free") +
labs(
title = paste("Partner's Decision by", subsetname, "and Gender"),
x = var,
y = "Count",
fill = "Decision"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No", "Yes"))
}
plot1 <- plot_decision_by_var(df_dating_race, "race_simple", "Subject's Race")
plot2 <- plot_decision_by_var(df_dating_race, "samerace", "Same Race")
gender_counts <- df_dating |>
count(gender, decision) |>
group_by(gender) |>
mutate(Percent = round(100 * n / sum(n), 1))
plot3 <- ggplot(gender_counts, aes(x = gender, y = n, fill = factor(decision))) +
geom_col(position = "dodge", alpha = 0.6) +
geom_text(
aes(label = paste0(n, " (", Percent, "%)")),
position = position_dodge(width = 0.9),
vjust = -0.4,
size = 3
) +
labs(
title = "Parner's Decision by Subject's Gender",
x = "Gender",
y = "Count",
fill = "Decision"
) +
theme( legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No","Yes")) +
theme_minimal(base_size = 14) +
theme(legend.position = "bottom"
plot_grid(
#| message: false
#| warning: false
#| echo: false
#| fig.width: 18
#| fig.height: 8
simplify_race <- function(x) {
x <- str_trim(as.character(x))
fct_collapse(
factor(x),
"Asian/PI" = c("Asian/Pacific Islander/Asian-American"),
"White" = c("European/Caucasian-American"),
"Latinx" = c("Latino/Hispanic American"),
"Black"= c("Black/African American"),
"Other"= c("Other", "?")
)
}
df_dating_race <-  df_dating %>%
mutate(
race_simple    = simplify_race(race),
race_o_simple  = simplify_race(race_o))
# Partner's decision by race, faceted by gender
plot_decision_by_var <- function(data, var, subsetname) {
ggplot(data, aes(x = .data[[var]], fill = factor(decision))) +
geom_bar(alpha = 0.5) +
facet_wrap(~ gender, scales = "free") +
labs(
title = paste("Partner's Decision by", subsetname, "and Gender"),
x = var,
y = "Count",
fill = "Decision"
) +
theme_minimal(base_size = 12) +
theme(axis.text.x = element_text(angle = 45, hjust = 1), legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No", "Yes"))
}
plot1 <- plot_decision_by_var(df_dating_race, "race_simple", "Subject's Race")
plot2 <- plot_decision_by_var(df_dating_race, "samerace", "Same Race")
gender_counts <- df_dating |>
count(gender, decision) |>
group_by(gender) |>
mutate(Percent = round(100 * n / sum(n), 1))
plot3 <- ggplot(gender_counts, aes(x = gender, y = n, fill = factor(decision))) +
geom_col(position = "dodge", alpha = 0.6) +
geom_text(
aes(label = paste0(n, " (", Percent, "%)")),
position = position_dodge(width = 0.9),
vjust = -0.4,
size = 3
) +
labs(
title = "Parner's Decision by Subject's Gender",
x = "Gender",
y = "Count",
fill = "Decision"
) +
theme( legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No","Yes")) +
theme_minimal(base_size = 14) +
theme(legend.position = "bottom")
plot_grid(
plot1, plot2, plot3,
ncol = 3,
nrow = 1,
align = "h"
)
#| message: false
#| warning: false
#| echo: false
#| fig-width: 20
#| fig-height: 15
library(cowplot)
# Density plot function
plot_kde_grid <- function(feat_subset, subset_name, data = df_dating) {
df_dating %>%
select(gender, decision, all_of(feat_subset)) %>%
pivot_longer(cols = all_of(feat_subset),
names_to = "Characteristic",
values_to = "Score") %>%
ggplot(aes(x = Score, fill = factor(decision))) +
geom_density(adjust = 1.5, alpha = 0.4) +
facet_grid(gender ~ Characteristic, scales = "free") +
labs(
title = paste(subset_name, "by Gender and Partner Decision"),
x = "Score",
y = "Density",
fill = "Partner Decision"
) +
theme_minimal(base_size = 12) +
theme(legend.position = "bottom") +
scale_fill_manual(values = class_colors, labels = c("No","Yes"))
}
plot_box_grid <- function(feat_subset,subset_name, data=df_dating){
df_dating %>%
select(gender, decision, all_of(feat_subset)) %>%
pivot_longer(cols = all_of(feat_subset),
names_to = "Characteristic",
values_to = "Score") %>%
ggplot(aes(y = Score ,fill=decision)) +
geom_boxplot(alpha = 0.5,linewidth=1) +
facet_grid(gender ~ Characteristic, scales = "free") +
labs(
title = paste(subset_name,"by Gender and Partner Decision"),
x = "Feature Name",
y = "Density"
) +
theme_minimal(base_size = 12) +
theme(legend.position = "bottom", axis.text.x = element_blank()) +
scale_fill_manual(values = class_colors, labels = c("No","Yes"))
}
partner_self_ratings <- c("attractive_o", "sinsere_o", "intelligence_o", "funny_o", "ambitous_o", "shared_interests_o")
subject_self_ratings <- c("attractive","sincere","intelligence","funny","ambition")
interests<- c("sports","tvsports","exercise","dining","museums","art","hiking","gaming","clubbing","reading","tv","theater","movies","concerts","music","shopping","yoga")
plot1 <- plot_kde_grid(subject_self_ratings, "Subject Self-Assessed Characteristics")
plot2 <- plot_kde_grid(partner_self_ratings, "Subjectâ€™s Perceived Characteristics")
plot3 <- plot_kde_grid(interests, "Subject Interests")
plot4 <- plot_box_grid(interests, "Subject Interests")
plot_grid(
plot1, plot2,
plot3, plot4,
label_size = 12,
ncol = 2,
nrow = 2,
rel_widths = c(1,1),
rel_heights = c(1, 1),
align = "hv"
)
